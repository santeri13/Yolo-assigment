# Yolo-assigment
Yolo assignment for Java backend position

## Stack
Java 24

Gradle(Kotlin)

Spring Boot

WebSocket(without STOMP)

## Application work
When the application works, the user can connect to the application and guess the right number with a bet on it. If the user guesses the number, he receives a message about his win and his bet back with a winnings of 9.9 times the stake. Results of the match will be shown to all users connected to it, as well as the guess number.

Application consists of:
1)Two constructions, bet which person place and win result of the bet, which includes information about the winner's result. 
2)backend code for calculating the results of the match
3) configuration of WebSocket without using STOMP
4)validator to check if the received data from the user is right
5)tests to check the proper work of the application (unit test, integration test, rtp)

### Constructures
Bet structure parameters:

| NAME     | DATATYPE     | DESCRIPTION                                     |
|----------|--------------|-------------------------------------------------|
| UUID     | String       | UUID of user, generated by backend              |
| nickname | String       | name of user, required                          |
| number   | int          | number which the user thinks is guest, required | 
| amount   | int          | amount of money for bet, required               |

WinResult structure parameters:

| NAME     | DATATYPE     | DESCRIPTION           |
|----------|--------------|-----------------------|
| nickname | String       | name of user          |
| win      | String       | amount of winning bet |
| UUID     | int          | UUID of user          | 

### WebSocket configuration

WebSocketConfig class creates a path for connection with the application via WebSocket, by default ws://localhost:8080/game

WebSocketHandler handles the connection between the user when the user establishes a connection with an application, when the user closes the application, and when the user sends a JSON request to the WebSocket.

When a user establishes a connection with an application, a random UUID is created, which would be used as an identifier for the current session and place him in the list with other users who are currently connected.

When a user sends his bet in the required JSON format, the application handles the message and creates an object, creates a new Bet object, and sends it to the GameService, where all calculations and actions related to the game work.

JSON message format:
```
{
    "nickname": "Alice",
    "number": 5,
    "amount": 100
}
```
When a user closes an application, he is removed from the list of connected users and his connection with the application via WebSocket is terminated.

### Backend work

When WebSocket receives a bet from the user, it sends it to the GameService class. All bets are placed in a HashMap connected to the user's UUID. Every 10 seconds, the runGameRound method runs the game round. When it happens, the backend takes a random number from 1 to 10 and checks if the user's number is the right one. If the user number was not correct, he received a message about his loss. If the user wins, his information is set to a list of winners, and he receives his bet back multiplied by 9.9. Results of the game (guest number, winners list) would be sent to all users who are currently connected with the application.

### Validator

The validator checks if the data in the Bet object is correct.

### Tests

The unit test checks the backend functionality of the application, which includes choosing a winning bet and losing, calculating the winning bet, and determining who wins.

Integration tests include tests related to the proper working of the WebSocket server that checks if the user and application have a connection, valid and invalid JSON messages, and more than one user can place their bet.

RTP test was something new for me, as I understand it checks how much money a user can win if he plays a specific number of rounds.

## Application start

First, you need Java 24 JDK. You can start the application by using [IntelliJ IDE platform](https://www.jetbrains.com/idea/download/?section=windows) and start the application from the file assigment/src/main/java/com/example/assigment/AssigmentApplication.java. When you start the application, you connect to the application via WebSocket (by default ws://localhost:8080/game) and send data via JSON message. You can do it by [Postman](https://www.postman.com/downloads/) program.

JSON message format:
```
{
    "nickname": "Alice",
    "number": 5,
    "amount": 100
}
```
